\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{multicol}
\usepackage{blindtext}
\usepackage{geometry}
\geometry{a4paper, left=5mm, right=5mm, top=5mm, bottom=12mm}
\setlength{\parindent}{0pt}
\setlength{\columnsep}{0.4cm}
\setlength{\columnseprule}{0.5pt}
\usepackage{enumitem}
\usepackage{svg}
\usepackage{dsfont}
\usepackage{hyperref}

\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{xparse}
\usepackage{bm}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage[per-mode = fraction]{siunitx}
\usepackage{calc}
\usepackage{cancel}

\usepackage{xcolor}
\definecolor{myblue}{cmyk}{1,.72,0,.38}
\definecolor{mygreen}{RGB}{78, 153, 67}     % A vibrant green
\definecolor{myred}{RGB}{220, 53, 69}       % A bright red
\definecolor{myyellow}{cmyk}{0,0,1,0}       % Pure yellow
\definecolor{mydarkblue}{cmyk}{1,.6,0,.4}   % A darker shade of blue
\definecolor{mypurple}{RGB}{104, 33, 122}   % A deep purple
\definecolor{myorange}{RGB}{253, 126, 20}   % A bright orange
\definecolor{mygray}{gray}{0.6}             % A medium gray, 0 is black, 1 is white
\definecolor{myteal}{RGB}{0,128,128}        % A teal color

%
% Various Helper Commands
%

% Such That
\newcommand{\st}{\text{s.t.}}

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}
\NewDocumentCommand{\func}{m o}{\text{#1}\IfValueT{#2}{(#2)}}

% For derivatives
\newcommand{\deriv}[2]{\frac{\mathrm{d}}{\mathrm{d}#1} (#2)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial#1} (#2)}

% Probability commands: Expectation, Variance, Covariance, Bias
\NewDocumentCommand{\E}{o}{\mathrm{E}\IfValueT{#1}{(#1)}}
\NewDocumentCommand{\Var}{o}{\mathrm{Var}\IfValueT{#1}{(#1)}}
\NewDocumentCommand{\Cov}{o}{\mathrm{Cov}\IfValueT{#1}{(#1)}}
\NewDocumentCommand{\Bias}{o}{\mathrm{Bias}\IfValueT{#1}{(#1)}}
\NewDocumentCommand{\Prob}{o}{\mathrm{Pr}\IfValueT{#1}{(#1)}}

% Col and Row Vectors
\newcommand{\crvector}[1]{\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}

% Defining Units that are not in the SI base
\DeclareSIUnit\bar{bar}
\DeclareSIUnit\foot{ft}
\DeclareSIUnit\inch{in}
\DeclareSIUnit\year{yr}
\DeclareSIUnit\hour{hr}
\DeclareSIUnit\failure{failure}
\DeclareSIUnit\cycle{cycle}
\DeclareSIUnit\DU{DU}
\DeclareSIUnit\AU{AU}
\DeclareSIUnit\TU{TU}
\DeclareSIUnit\dollar{\$}
\DeclareSIUnit\cent{\text{\textcent}}
\DeclareSIUnit\c{\degreeCelsius}

% Griffiths script char LOL
\def\rcurs{{\mbox{$\resizebox{.09in}{.08in}{\includegraphics[trim= 1em 0 14em 0,clip]{./ScriptR}}$}}}
\def\brcurs{{\mbox{$\resizebox{.09in}{.08in}{\includegraphics[trim= 1em 0 14em 0,clip]{./BoldR}}$}}}

% Code Listing config
\usepackage{xcolor}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{overleaf}{
	% backgroundcolor=\color{backcolour},
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	tabsize=4
}

% \usepackage[latte]{catppuccinpalette}
% \lstdefinestyle{catppuccin}{
% 	breaklines=true,
% 	keepspaces=true,
% 	numbers=left,
% 	numbersep=5pt,
% 	showspaces=false,
% 	showstringspaces=false,
% 	breakatwhitespace=true,
% 	tabsize=4,
% 	stringstyle = {\color{CtpGreen}},
% 	commentstyle={\color{CtpOverlay1}},
% 	basicstyle = {\small\color{CtpText}\ttfamily},
% 	keywordstyle = {\color{CtpMauve}},
% 	keywordstyle = [2]{\color{CtpBlue}},
% 	keywordstyle = [3]{\color{CtpYellow}},
% 	keywordstyle = [4]{\color{CtpLavender}},
% 	keywordstyle = [5]{\color{CtpPeach}},
% 	keywordstyle = [6]{\color{CtpTeal}}
% }

\lstset{style=overleaf}

% TikZ settings for diagrams
\usepackage{tikz}
\usetikzlibrary{shapes,positioning,arrows,fit,calc,graphs,graphs.standard}

% Font and typography settings
\usepackage[T1]{fontenc}
\usepackage[nosf]{kpfonts} % Keeping kpfonts for mathematical symbols
\usepackage{sourcesanspro} % Sans-serif font for clarity

% Microtype for improved typography
\usepackage{microtype}

% Apply color to all math environments
% \everymath{\color{myblue}}
% \everydisplay{\color{myblue}}

% Customized spacing
\renewcommand{\baselinestretch}{.8}

% Page footers
\pagestyle{fancy}
\lfoot{\fsheetCourse: \fsheetExam}
\rfoot{\fsheetAuthor}

% Layer declaration for TikZ drawings
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\usepackage{titlesec} % For customizing section titles
% Redefining section titles for a more compact look
\titleformat{\section}
  {\normalfont\large\sffamily\bfseries\color{myblue}}
  {\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\normalsize\sffamily\bfseries\color{mygreen}}
  {\thesubsection}{1em}{}
\titleformat{\subsubsection}
  {\normalfont\normalsize\sffamily\bfseries\color{mypurple}}
  {\thesubsubsection}{1em}{}

% Adjust spacing before and after section titles
\titlespacing*{\section}{0pt}{1ex plus 1ex minus .2ex}{0.5ex plus .2ex}
\titlespacing*{\subsection}{0pt}{1ex plus 1ex minus .2ex}{0.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{1ex plus 1ex minus .2ex}{0.5ex plus .2ex}

% Adjust spacing for enumerate environment to make it more compact
\setlist[enumerate]{
    topsep=0pt, % Space between the first item and the preceding paragraph
    partopsep=0pt, % Extra space added to topsep when environment starts a new paragraph
    parsep=0pt, % Space between paragraphs within an item
    itemsep=1pt, % Space between items
    leftmargin=* % Adjusts the left margin to align with the surrounding text
}
\setlist[itemize]{
    topsep=0pt, % Space between the first item and the preceding paragraph
    partopsep=0pt, % Extra space added to topsep when environment starts a new paragraph
    parsep=0pt, % Space between paragraphs within an item
    itemsep=1pt, % Space between items
    leftmargin=* % Adjusts the left margin to align with the surrounding text
}

% Reduce spacing around all display math, affecting align environments
\AtBeginDocument{
  \setlength{\abovedisplayskip}{0pt} % Space above display math
  \setlength{\abovedisplayshortskip}{0pt} % Space above display math when preceding text line is short
  \setlength{\belowdisplayskip}{0pt} % Space below display math
  \setlength{\belowdisplayshortskip}{0pt} % Space below display math when following text line is short
}
